/*//////////////////////////////////////////////////////////////////
////     The SKIRT project -- advanced radiative transfer       ////
////       Â© Astronomical Observatory, Ghent University         ////
///////////////////////////////////////////////////////////////// */

#include "Trust1Geometry.hpp"
#include "Constants.hpp"
#include "Random.hpp"

//////////////////////////////////////////////////////////////////////

void Trust1Geometry::setupSelfBefore()
{
    GenGeometry::setupSelfBefore();

    // set property values
    double pc = Constants::pc();
    _slab = Box(-5*pc, -5*pc, -5*pc, 5*pc, 5*pc, -2*pc);
    _rho = 1.0 / _slab.volume();
}

//////////////////////////////////////////////////////////////////////

double Trust1Geometry::density(Position bfr) const
{
    return _slab.contains(bfr) ? _rho : 0;
}

//////////////////////////////////////////////////////////////////////

Position Trust1Geometry::generatePosition() const
{
    return random()->position(_slab);
}

//////////////////////////////////////////////////////////////////////

double Trust1Geometry::SigmaX() const
{
    return 0;
}

//////////////////////////////////////////////////////////////////////

double Trust1Geometry::SigmaY() const
{
    return 0;
}

//////////////////////////////////////////////////////////////////////

double Trust1Geometry::SigmaZ() const
{
    return _rho * _slab.zwidth();
}

//////////////////////////////////////////////////////////////////////
